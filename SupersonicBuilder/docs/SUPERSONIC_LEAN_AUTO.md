# ğŸš€ SonicBuilder Supersonic Lean Auto Installer

**Trace-Enabled Edition with GitHub Integration**

---

## ğŸ“‹ Overview

The Lean Auto Installer creates standalone SonicBuilder Supersonic environments with:
- âœ… **Build traceability** - Embeds GitHub tag/commit in config
- âœ… **Environment reporting** - Generates BUILD_REPORT.md
- âœ… **Flexible sources** - GitHub or local file updates
- âœ… **Complete skeleton** - Ready-to-use directory structure

---

## ğŸ¯ Features

### Build Tracing
Every generated environment includes:
- GitHub repository URL in config
- Latest tag or commit hash
- Timestamp and system info in BUILD_REPORT.md

### Dual Source Mode
- **GitHub Mode**: Auto-downloads latest from repository
- **Local Mode**: Copies from local builders directory

### Generated Structure
```
supersonic_lean/
â”œâ”€â”€ builder.py                    # Supersonic builder
â”œâ”€â”€ supersonic_build_all.py       # Full automation
â”œâ”€â”€ sonicbuilder.config.json      # With build_origin
â”œâ”€â”€ CHANGELOG.md                  # Version history
â”œâ”€â”€ BUILD_REPORT.md               # Environment trace
â””â”€â”€ SonicBuilder/
    â”œâ”€â”€ dsp/
    â”œâ”€â”€ docs/
    â”œâ”€â”€ extras/
    â””â”€â”€ tools/
        â””â”€â”€ diff_render_html.py
```

---

## ğŸš€ Quick Start

### Using Makefile
```bash
make supersonic-lean-auto
```

### Direct Execution
```bash
python3 builders/make_supersonic_lean_auto.py
```

### Interactive Prompts
```
Target directory: /path/to/supersonic_lean
Update source: local
supersonic_lean exists. Overwrite? (y/N):
```

---

## âš™ï¸ Configuration

### Update Source

Edit `builders/make_supersonic_lean_auto.py`:

```python
UPDATE_SOURCE = "github"   # or "local"
```

#### GitHub Mode
```python
UPDATE_SOURCE = "github"
GITHUB_USER = "ChristopherElgin"
REPO_NAME = "SonicBuilderSupersonic"
```

**Fetches:**
- Latest tag (e.g., v3.2.1)
- Or latest commit hash (7-char)
- Downloads files from main branch

#### Local Mode
```python
UPDATE_SOURCE = "local"
LOCAL_SOURCE_DIR = ROOT / "builders"
```

**Copies:**
- Files from local builders directory
- No internet connection required
- Uses current project files

---

## ğŸ“„ Generated Files

### sonicbuilder.config.json
Includes build traceability:
```json
{
  "project_name": "SonicBuilder",
  "version": "v3.2.1",
  "build_origin": {
    "repo": "https://github.com/ChristopherElgin/SonicBuilderSupersonic",
    "tag_or_commit": "v3.2.1"
  }
}
```

### BUILD_REPORT.md
Complete environment snapshot:
```markdown
# SonicBuilder Supersonic Build Report

**Timestamp (UTC):** 2025-11-01T02:00:00Z  
**Python:** 3.11.6  
**System:** Linux-5.15.0-x86_64  

**Repo:** https://github.com/ChristopherElgin/SonicBuilderSupersonic  
**Tag/Commit:** v3.2.1  

This record was automatically generated by make_supersonic_lean_auto.py  
to maintain traceability of build origin and environment.
```

---

## ğŸ”„ GitHub Repository Setup

### For SonicBuilderSupersonic Repository

#### 1. Create Repository Structure
```
SonicBuilderSupersonic/
â”œâ”€â”€ builder.py                    # Supersonic builder
â”œâ”€â”€ supersonic_build_all.py       # Build automation
â”œâ”€â”€ make_demo_dark_pdf.py         # Dark PDF generator
â”œâ”€â”€ make_demo_light_pdf.py        # Light PDF generator
â”œâ”€â”€ sonicbuilder.config.json      # Configuration
â”œâ”€â”€ CHANGELOG.md                  # Changelog
â””â”€â”€ SonicBuilder/
    â”œâ”€â”€ dsp/
    â”‚   â””â”€â”€ sample_dsp_config.json
    â”œâ”€â”€ docs/
    â”‚   â”œâ”€â”€ demo_dark.pdf
    â”‚   â””â”€â”€ demo_light.pdf
    â”œâ”€â”€ extras/
    â””â”€â”€ tools/
        â””â”€â”€ diff_render_html.py
```

#### 2. Initialize and Push
```bash
git init
git add .
git commit -m "Initial Supersonic commit"
git remote add origin https://github.com/ChristopherElgin/SonicBuilderSupersonic.git
git branch -M main
git push -u origin main
```

#### 3. Create Release Tag
```bash
git tag v3.2.1
git push origin v3.2.1
```

---

## ğŸ¯ Usage Workflows

### Create Local Lean Package
```bash
# Use local files (default)
make supersonic-lean-auto
cd supersonic_lean
python supersonic_build_all.py
```

### Pull from GitHub
Edit `UPDATE_SOURCE = "github"` in script, then:
```bash
make supersonic-lean-auto
```

### Distribute to Team
```bash
# Create lean package
make supersonic-lean-auto

# Archive it
cd supersonic_lean
zip -r ../SonicBuilder_Lean_v3.2.1.zip .

# Share with team
# They can unzip and run immediately
```

### Verify Build Origin
```bash
cd supersonic_lean
cat BUILD_REPORT.md
cat sonicbuilder.config.json | grep -A3 build_origin
```

---

## ğŸ“Š File Mapping

### GitHub Mode
| Remote Path | Local Path |
|-------------|------------|
| `builder.py` | `supersonic_lean/builder.py` |
| `supersonic_build_all.py` | `supersonic_lean/supersonic_build_all.py` |
| `SonicBuilder/tools/diff_render_html.py` | `supersonic_lean/SonicBuilder/tools/diff_render_html.py` |

### Local Mode
| Source | Destination |
|--------|-------------|
| `builders/sonicbuilder_supersonic.py` | `supersonic_lean/builder.py` |
| `builders/supersonic_build_all.py` | `supersonic_lean/supersonic_build_all.py` |
| `SonicBuilder/tools/diff_render_html.py` | `supersonic_lean/SonicBuilder/tools/diff_render_html.py` |

---

## ğŸ” API Integration

### GitHub API Calls

**Fetch Latest Tag:**
```
GET https://api.github.com/repos/ChristopherElgin/SonicBuilderSupersonic/tags
```

**Fetch Latest Commit:**
```
GET https://api.github.com/repos/ChristopherElgin/SonicBuilderSupersonic/commits
```

**Download Raw File:**
```
GET https://raw.githubusercontent.com/ChristopherElgin/SonicBuilderSupersonic/main/builder.py
```

---

## ğŸ› Troubleshooting

### GitHub Access Fails
```
[warn] could not fetch tag/commit: URLError
```

**Solutions:**
1. Check internet connection
2. Verify repository is public
3. Switch to local mode
4. Check GitHub API rate limits

### Missing Local Files
```
[warn] missing local builders/sonicbuilder_supersonic.py
```

**Solution:** Ensure all required files exist in builders directory.

### Permission Denied
```
PermissionError: [Errno 13] Permission denied: 'supersonic_lean'
```

**Solution:** Delete existing directory or choose different name.

---

## ğŸ“ˆ Advanced Usage

### Custom GitHub Repository
```python
GITHUB_USER = "YourUsername"
REPO_NAME = "YourSonicBuilderFork"
```

### Custom File Mapping
```python
FILES = {
    "builder.py": "sonicbuilder_supersonic.py",
    "custom_tool.py": "custom_tool.py",
    "SonicBuilder/tools/diff_render_html.py": "../SonicBuilder/tools/diff_render_html.py",
}
```

### Add Custom Files
```python
# In make_skeleton function
write(target_dir / "README.md", """
# My Custom Supersonic Build
...
""")
```

---

## ğŸ‰ Summary

The Trace-Enabled Lean Auto Installer provides:
- âœ… **Full traceability** - Know exactly what version you're running
- âœ… **Flexible deployment** - GitHub or local sources
- âœ… **Environment reports** - Complete build metadata
- âœ… **Team distribution** - Easy sharing with full context
- âœ… **Version control** - Tag/commit tracking in config

Perfect for:
- Team collaboration
- Version tracking
- Build auditing
- Deployment verification
- Offline distribution

---

**Location:** `builders/make_supersonic_lean_auto.py`  
**Makefile:** `make supersonic-lean-auto`  
**Output:** `supersonic_lean/` directory
